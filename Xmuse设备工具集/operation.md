# EEG信号处理工具使用手册

## 1. 数据格式转换工具

### 1.1 EDF转CSV转换
1. 打开 `Convert_EDF_CSV.txt`
2. 修改文件路径：
```python
edf_file = 'C:\\Users\\PC\\Desktop\\滤波.edf'  # 修改为您的EDF文件路径
csv_file = 'C:\\Users\\PC\\Desktop\\output_file.csv'  # 修改为期望的输出CSV文件路径
```
3. 运行程序后，将：
   - 读取EDF文件
   - 获取EEG数据和通道名称
   - 转换为DataFrame格式
   - 保存为CSV文件

### 1.2 CSV转NPY转换
1. 打开 `Convert_CSV_to_NPY.txt`
2. 修改文件路径：
```python
df = pd.read_csv('输入您的CSV文件路径内容.csv')
np.save('输入您想要保存的NPY文件路径内容.npy', data_array_transposed)
```
3. 程序会：
   - 读取CSV文件
   - 转换为NumPy数组
   - 进行转置处理
   - 保存为NPY格式

### 1.3 信号类型提取
1. 打开 `Extract_Signal_type.txt`
2. 设置输入输出路径：
```python
input_file = "输入文件路径"
output_dir = "输出目录路径"
```
3. 程序功能：
   - 自动创建日志目录
   - 记录处理过程
   - 提取不同类型的信号
   - 分别保存为独立的CSV文件

## 2. 信号滤波处理

### 2.1 功能说明
提供基于FFT的频域滤波，包括：
- 高通滤波：去除低频漂移
- 低通滤波：去除高频噪声
- 带通滤波：保留特定频段
- 陷波滤波：去除工频干扰（50Hz）

### 2.2 使用步骤
1. 打开 `高通滤波、低通滤波、带通滤波、陷波滤波.txt`
2. 修改输入文件路径：
```python
file_path = "输入您的Xmuse.npy文件路径"
```
3. 设置滤波参数：
```python
fs = 256  # 采样频率
high_cutoff = 2  # 高通截止频率 (Hz)
low_cutoff = 40  # 低通截止频率 (Hz)
band_cutoff = [2, 40]  # 带通频率范围 (Hz)
notch_cutoff = [49, 51]  # 陷波频率范围 (Hz)
```

### 2.3 输出结果
程序会为每个通道生成四组对比图：
- 原始信号与高通滤波对比（包含基线恢复）
- 原始信号与低通滤波对比
- 原始信号与带通滤波对比（包含基线恢复）
- 原始信号与陷波滤波对比

## 3. 信号特征分析

### 3.1 功能说明
计算以下特征：
- 五个频段的绝对功率和相对功率：
  - delta (1-4 Hz)
  - theta (4-8 Hz)
  - alpha (8-13 Hz)
  - beta (13-30 Hz)
  - gamma (30-45 Hz)
- 频谱熵
- Hjorth参数（活动度、移动度、复杂度）
- 功率谱密度图

### 3.2 使用步骤
1. 打开 `各个通道绝对功率、相对功率、频谱熵、Hjorth参数以及频谱图.txt`
2. 设置参数：
```python
data_path = "您的CSV文件路径"
window = 1.0    # 窗口大小（秒）
frame = 0.5     # 帧移动大小（秒）
sample_rate = 256  # 采样率
channels = 4    # 通道数
```

### 3.3 输出说明
程序会为每个通道输出：
- 各频段的绝对功率值
- 各频段的相对功率百分比
- 频谱熵值
- Hjorth参数三个指标
- 功率谱密度可视化图

## 4. 时间戳转换工具

### 4.1 使用步骤
1. 打开时间戳转换程序
2. 修改文件路径：
```python
input_csv = "C:\\Users\\PC\\Desktop\\正式实验\\S04\\close.csv"  # 输入CSV文件路径
output_csv = "C:\\Users\\PC\\Desktop\\正式实验\\S04\\close_北京时间.csv"  # 输出CSV文件路径
```
3. 程序会：
   - 读取原始CSV文件
   - 转换UTC时间戳为北京时间
   - 保留精确到毫秒的时间格式
   - 生成新的CSV文件

## 5. 注意事项

### 5.1 数据格式要求
- EDF文件应为标准脑电格式
- CSV文件需确保分隔符正确
- 确保数据完整性和通道数量正确

### 5.2 参数设置
- 采样率要与实际数据匹配
- 滤波参数根据实际需求调整
- 窗口大小影响分析精度

### 5.3 结果验证
- 观察滤波效果图
- 检查频谱特征变化
- 验证功率计算结果
- 确认所有通道数据正确

## 6. 常见问题解决

### 6.1 数据加载问题
- 检查文件路径正确性
- 确认文件编码格式
- 验证数据格式完整性
- 检查数据类型匹配

### 6.2 处理效果问题
- 调整滤波器参数
- 验证频率范围设置
- 检查基线漂移处理
- 确认计算结果合理性

### 6.3 结果验证
- 观察滤波效果图
- 检查频谱特征变化
- 验证功率计算结果
- 确认时间戳转换准确性
